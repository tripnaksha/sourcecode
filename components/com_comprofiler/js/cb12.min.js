function cbsaveorder(a,g,b,c,e,d){cbCheckAllRowsAndSubTask(a,g,b,e,d);submitform(c)}function cbCheckAllRowsAndSubTask(a,g,b,e,d){if(!b){b="cb"}f=cbParentForm(a);for(var c=0;c<g;c++){box=f.elements[b+c];if(box.checked==false){box.checked=true}}if(e&&d){f.elements[e].value=d}}function cbToggleAll(tgl,n,fldName){if(!fldName){fldName="cb"}var frm=tgl.form;for(i=0;i<n;i++){cb=eval("frm."+fldName+i);if(cb){cb.checked=tgl.checked}}return true}function cbParentForm(a){var b;if(a==window){b=window.event.srcElement}else{b=a}while(b){b=b.parentNode;if(b.nodeName=="FORM"){break}}return b}function cbListItemTask(a,c,e,d,b,h){var g=cbParentForm(a);if(a){for(i=0;true;i++){cbx=g.elements[b+i];if(!cbx){break}if(i==h){cbx.checked=true}else{cbx.checked=false}}g.elements[e].value=d;submitbutton(c)}return false}function cbDoListTask(a,c,g,e,b){var h=document.forms.adminForm;if(a){var d=false;for(i=0;true;i++){cbx=h.elements[b+i];if(!cbx){break}if(cbx.checked){d=true;break}}if(d){if(e=="deleterows"){if(!confirm("Are you sure you want to delete selected items ?")){return false}}h.elements[g].value=e;submitbutton(c)}else{alert("no items selected")}}return false}function submitbutton(a){if(a=="showPlugins"||a=="cancelPlugin"||a=="cancelPluginAction"){cbsubmitform(a);return false}var b=document.forms.adminForm;if((typeof(b.elements.name)!="undefined")&&(b.elements.name.value=="")){alert("Plugin must have a name")}else{cbsubmitform(a)}return false}function cbsubmitform(a){document.forms.adminForm.elements.task.value=a;if(typeof(document.forms.adminForm)!="undefined"){try{document.forms.adminForm.onsubmit()}catch(b){}}document.forms.adminForm.submit()}var cbW3CDOM=(document.createElement&&document.getElementsByTagName);function cbGetElementsByClass(h,e,a){var d=new Array();if(e==null){e=document}if(a==null){a="*"}var c=e.getElementsByTagName(a);var b=c.length;var g=new RegExp("(^|\\s)"+h+"(\\s|$)");for(i=0,j=0;i<b;i++){if(g.test(c[i].className)){d[j]=c[i];j++}}return d}function cbAddEvent(d,c,a){if(d.addEventListener){d.addEventListener(c,a,true);return true}else{if(d.attachEvent){var b=d.attachEvent("on"+c,a);return b}else{return false}}}function cbAddEventObjArray(objArr,evType,fn){for(var j=0;j<objArr.length;j++){if(objArr[j].type!="hidden"){eval("objArr[j].on"+evType+"=fn")}}}function cbInitFiltersBlur(){if(!cbW3CDOM){return}var b=cbGetElementsByClass("cbFilters");if((b.length==1)&&(b[0].getElementsByTagName("input").length==1)){for(var a=0;a<b.length;a++){cbAddEventObjArray(b[a].getElementsByTagName("input"),"change",cbFilterInputBlur);cbAddEventObjArray(b[a].getElementsByTagName("select"),"change",cbFilterInputBlur)}}}function cbFilterInputBlur(a){cbParentForm(this).submit();return false}cbAddEvent(window,"load",cbInitFiltersBlur);var cbHideFields=new Array();var cbParamsSaveBefHide=new Array();var cbSels=new Array();var cbPreviousOnChangeValues=new Array();function cbGetDisplayStyle(a){var b;if(a.style.getPropertyValue){b=a.style.getPropertyValue("display")}else{b=a.style.display}return b}function cbParamChange(){var l=new Array();var c=new Array();var o,q,b,n;var p=false;var g,e,d,h;for(g=0;g<cbHideFields.length;g++){for(e=1;e<cbSels[g].length;e++){if(cbSels[g][e].type!="hidden"){if((cbSels[g][e].type=="radio")||(cbSels[g][e].type=="checkbox")){if(cbSels[g][e].checked){o=cbSels[g][e].value}}else{o=cbSels[g][e].value}}}var m=false;switch(cbHideFields[g][2]){case"==":if(o==cbHideFields[g][3]){m=true}break;case"!=":if(o!=cbHideFields[g][3]){m=true}break;case">=":if(o>=cbHideFields[g][3]){m=true}break;case"<=":if(o<=cbHideFields[g][3]){m=true}break;case">":if(o>cbHideFields[g][3]){m=true}break;case"<":if(o<cbHideFields[g][3]){m=true}break;case"regexp":var a=new RegExp(cbHideFields[g][3]);m=(!a.test(o));break;case"evaluate":break;default:alert('js error operator "'+cbHideFields[g][2]+'" unknown.');break}if(cbHideFields[g][2]=="evaluate"){if(typeof(cbPreviousOnChangeValues[cbHideFields[g][1]])!="undefined"){if(cbPreviousOnChangeValues[cbHideFields[g][1]]!=o){p=true}}cbPreviousOnChangeValues[cbHideFields[g][1]]=o}else{if(m){for(e=0;e<l.length;e++){for(d=0;d<cbHideFields[g][4].length;d++){if(cbHideFields[g][4][d]==l[e]){l.splice(e,1)}}}c=c.concat(cbHideFields[g][4]);if(cbHideFields[g][5].length>0){if(cbGetDisplayStyle(document.getElementById(cbHideFields[g][0]))!="none"){for(e=0;e<cbHideFields[g][5].length;e++){q=cbHideFields[g][5][e].split("=",3);if(cbGetDisplayStyle(document.getElementById(cbHideFields[g][4][0]))!="none"){b=document.getElementById(q[1]);if(typeof(cbParamsSaveBefHide[g])=="undefined"){cbParamsSaveBefHide[g]=new Array()}cbParamsSaveBefHide[g][e]=b.value;b.value=q[2]}}}}}else{h=false;for(e=0;e<c.length;e++){for(d=0;d<cbHideFields[g][4].length;d++){if(cbHideFields[g][4][d]==c[e]){h=true}}}if(!h){l=l.concat(cbHideFields[g][4]);if(cbHideFields[g][5].length>0){for(e=0;e<cbHideFields[g][5].length;e++){q=cbHideFields[g][5][e].split("=",3);if(cbGetDisplayStyle(document.getElementById(cbHideFields[g][4][0]))=="none"){b=document.getElementById(q[1]);b.value=cbParamsSaveBefHide[g][e]}}}}}}}if(typeof(jQuery)=="undefined"){for(g=0;g<l.length;g++){n=document.getElementById(l[g]);if(n){n.style.display=""}else{alert("field not found number: "+g+" id:"+l[g])}}for(g=0;g<c.length;g++){n=document.getElementById(c[g]);if(n){n.style.display="none"}else{alert("field not found number: "+g+" id:"+c[g])}}}else{for(g=0;g<l.length;g++){jQuery(document.getElementById(l[g])).fadeIn("slow")}for(g=0;g<c.length;g++){jQuery(document.getElementById(c[g])).fadeOut("slow",function(){jQuery(this).hide()})}}if(p){cbParentForm(this).submit();return false}}function cbInitFields(){if(!cbW3CDOM){return}if(typeof(overlib_pagedefaults)!="undefined"){overlib_pagedefaults(WIDTH,250,VAUTO,RIGHT,AUTOSTATUSCAP,CSSCLASS,TEXTFONTCLASS,"cb-tips-font",FGCLASS,"cb-tips-fg",BGCLASS,"cb-tips-bg",CAPTIONFONTCLASS,"cb-tips-capfont",CLOSEFONTCLASS,"cb-tips-closefont")}if(typeof(cbHideFields)=="undefined"){return}for(var e=0;e<cbHideFields.length;e++){var d=document.getElementById(cbHideFields[e][0]);if(d===null){alert("xml name "+cbHideFields[e][0]+" is undefined. It is cbHideFields["+e+"][0].")}else{var a=d.getElementsByTagName("input");if(a.length==0){a=d.getElementsByTagName("select")}var b=1;cbSels[e]=new Array();cbSels[e][0]=d;for(var c=0;c<a.length;c++){if(a[c].type!="hidden"){if(a[c].type=="text"){cbAddEvent(a[c],"change",cbParamChange)}else{cbAddEvent(a[c],"click",cbParamChange)}cbSels[e][b++]=a[c]}}}}cbParamChange()}cbAddEvent(window,"load",cbInitFields);function CBgetHttpRequestInstance(){var b=false;if(window.XMLHttpRequest){b=new XMLHttpRequest();if(b.overrideMimeType){b.overrideMimeType("text/xml")}}else{if(window.ActiveXObject){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}}return b}function CBmakeHttpRequest(b,g,a,d,e){if((arguments.length<5)||(e==null)){e=CBgetHttpRequestInstance()}if(!e){return false}e.onreadystatechange=function(){c(e)};if(d==null){e.open("GET",b,true);e.send(null)}else{e.open("POST",b,true);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.setRequestHeader("Content-length",d.length);e.send(d)}function c(h){if(h.readyState==4){if((h.status==200)&&(h.responseText.length>0)&&(h.responseText.length<1025)){document.getElementById(g).innerHTML=h.responseText}else{if(a.length>0){document.getElementById(g).innerHTML=a}else{document.getElementById(g).innerHTML=""}}h=null}}return true};