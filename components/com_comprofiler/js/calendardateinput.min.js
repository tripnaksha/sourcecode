var cbcalDefaultDateFormat="MM/DD/YYYY";var cbcalHideWait=4;var cbcalY2kPivotPoint=76;var cbcalUnselectedMonthText="";var cbcalFontSize=11;var cbcalFontSizeDay=14;var cbcalFontFamily="Tahoma";var cbcalCellWidth=26;var cbcalCellHeight=24;var cbcalImageURL=cbTemplateDir+"calendar_icon.jpg";var cbcalNextURL=cbTemplateDir+"calendar_next.gif";var cbcalPrevURL=cbTemplateDir+"calendar_prev.gif";var cbcalCalBGColor="#F4F4F4";var cbcalTopRowBGColor="#DDD";var cbcalDayBGColor="#CCCCFF";var cbcalZCounter=100;var cbcalToday=new Date();var cbcalWeekDays=Calendar._SDN;var cbcalMonthDays=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var cbcalMonthNames=Calendar._MN;function cbcalYearDigitsOnly(b){var a=(b.keyCode)?b.keyCode:b.which;return((a==8)||(a==9)||(a==37)||(a==39)||(a==46)||((a>47)&&(a<58)))}function cbcalGetTagPixels(a,c){var b=(c=="LEFT")?a.offsetLeft:a.offsetTop;while((a.tagName!="BODY")&&(a.tagName!="HTML")){a=a.offsetParent;b+=(c=="LEFT")?a.offsetLeft:a.offsetTop}return b}function cbcalBehindCal(c,e,f,b,i,g){var a=cbcalGetTagPixels(c,"LEFT");var d=a+c.offsetWidth;var h=g+c.offsetHeight;return(((g<i)&&(h>b))&&((a<f)&&(d>e)))}function cbcalFixSelectLists(k){if(navigator.appName=="Microsoft Internet Explorer"){var g=this.getCalendar();var e=g.offsetLeft;var f=e+g.offsetWidth;var a=g.offsetTop;var h=a+(cbcalCellHeight*9);var b=false;formLoop:for(var c=this.formNumber;c<document.forms.length;c++){for(var d=0;d<document.forms[c].elements.length;d++){if(typeof document.forms[c].elements[d].type=="string"){if((document.forms[c].elements[d].type=="hidden")&&(document.forms[c].elements[d].name==this.hiddenFieldName)){b=true;d+=3}if(b){if(document.forms[c].elements[d].type.substr(0,6)=="select"){ListTopY=cbcalGetTagPixels(document.forms[c].elements[d],"TOP");if(ListTopY<h){if(cbcalBehindCal(document.forms[c].elements[d],e,f,a,h,ListTopY)){document.forms[c].elements[d].style.visibility=(k)?"hidden":"visible"}}else{break formLoop}}}}}}}}function cbcalDayCellHover(d,a,c,e){d.style.backgroundColor=(a)?cbcalDayBGColor:c;if(a){if((this.yearValue==cbcalToday.getFullYear())&&(this.monthIndex==cbcalToday.getMonth())&&(e==cbcalToday.getDate())){self.status="Click to select today"}else{var b=e.toString();switch(b.substr(b.length-1,1)){case"1":b+=(e==11)?"th":"st";break;case"2":b+=(e==12)?"th":"nd";break;case"3":b+=(e==13)?"th":"rd";break;default:b+="th";break}self.status="Click to select "+this.monthName+" "+b}}else{self.status=""}return true}function cbcalPickDisplayDay(c){this.show();var f=this.getMonthList();var b=this.getDayList();var a=this.getYearField();var g=((b.options[0].value=="")?1:0);cbcalFixDayList(b,cbcalGetDayCount(this.displayed.yearValue,this.displayed.monthIndex));for(var e=0;e<f.length;e++){if(f.options[e].value==this.displayed.monthIndex){f.options[e].selected=true}}for(var d=1;d<=(b.length-g);d++){if(d==c){b.options[d-1+g].selected=true}}this.setPicked(this.displayed.yearValue,this.displayed.monthIndex,c);a.value=this.picked.yearPad;a.defaultValue=a.value;this.hideElements(false)}function cbcalBuildCalendarDays(){var c=5;if(((this.displayed.dayCount==31)&&(this.displayed.firstDay>4))||((this.displayed.dayCount==30)&&(this.displayed.firstDay==6))){c=6}else{if((this.displayed.dayCount==28)&&(this.displayed.firstDay==0)){c=4}}var d='<table width="'+(cbcalCellWidth*7)+'" cellspacing="0" cellpadding="1" style="cursor:default">';for(var a=0;a<c;a++){d+="<tr>";for(var b=1;b<=7;b++){Day=(a*7)+(b-this.displayed.firstDay);if((Day>=1)&&(Day<=this.displayed.dayCount)){if((this.displayed.yearValue==this.picked.yearValue)&&(this.displayed.monthIndex==this.picked.monthIndex)&&(Day==this.picked.day)){TextStyle="color:white;font-weight:bold;";BackColor=cbcalDayBGColor}else{TextStyle="color:black;";BackColor=cbcalCalBGColor}if((this.displayed.yearValue==cbcalToday.getFullYear())&&(this.displayed.monthIndex==cbcalToday.getMonth())&&(Day==cbcalToday.getDate())){TextStyle+="border:1px solid darkred;padding:0px;"}d+='<td align="center" class="calendarDayInput" style="cursor:default;height:'+cbcalCellHeight+"px;width:"+cbcalCellWidth+"px;"+TextStyle+";background-color:"+BackColor+'" onClick="'+this.objName+".pickDay("+Day+')" onMouseOver="return '+this.objName+".displayed.dayHover(this,true,'"+BackColor+"',"+Day+')" onMouseOut="return '+this.objName+".displayed.dayHover(this,false,'"+BackColor+"')\">"+Day+"</td>"}else{d+='<td class="calendarDateInput" style="height:'+cbcalCellHeight+'">&nbsp;</td>'}}d+="</tr>"}return d+="</table>"}function cbcalGetGoodYear(c){if(c>100){return c}else{var b=parseInt(c,10)%100;var a=(b<cbcalY2kPivotPoint)?2000:1900;return a+b}}function cbcalGetDayCount(a,b){return((b==1)&&((a%400==0)||((a%4==0)&&(a%100!=0))))?29:cbcalMonthDays[b]}function cbcalVirtualButton(b,a){if(a){b.style.borderLeft="buttonshadow 1px solid";b.style.borderTop="buttonshadow 1px solid";b.style.borderBottom="buttonhighlight 1px solid";b.style.borderRight="buttonhighlight 1px solid"}else{b.style.borderLeft="buttonhighlight 1px solid";b.style.borderTop="buttonhighlight 1px solid";b.style.borderBottom="buttonshadow 1px solid";b.style.borderRight="buttonshadow 1px solid"}}function cbcalNeighborHover(b,a,c){if(a){cbcalVirtualButton(b,false);self.status="Click to view "+c.fullName}else{b.style.border="buttonface 1px solid";self.status=""}return true}function cbcalFixDayList(c,f){var e=((c.options[0].value=="")?1:0);var a=c.selectedIndex+1-e;if(a==0){a=1;c.options[a-1+e].selected=true}if(f!=(c.length-e)){var d=c.length-e;for(var b=Math.min(f,d);b<Math.max(f,d);b++){(b>=f)?c.options[f+e]=null:c.options[b+e]=new Option(b+1,b+1)}a=Math.min(a,f);c.options[a-1+e].selected=true}return a}function cbcalFixYearList(e,b){var c=((e.options[0].value=="")?1:0);if(e.options[1].value<100){b=b%100}var d=e.options[e.selectedIndex].value;for(var a=c;a<e.options.length;a++){if(e.options[a].value==b){d=b;break}}if(a<e.options.length){e.options[a].selected=true}return d}function FixYearInput(a){var b=new RegExp("\\d{"+a.defaultValue.length+"}");if(!b.test(a.value)){a.value=a.defaultValue}}function cbcalCalIconHover(b){var a=(this.isShowing())?"hide":"show";self.status=(b)?"Click to "+a+" the calendar":"";return true}function cbcalCalTimerReset(){eval("clearTimeout("+this.timerID+")");eval(this.timerID+"=setTimeout('"+this.objName+".show()',"+(cbcalHideWait*1000)+")")}function cbcalDoTimer(CancelTimer){if(CancelTimer){eval("clearTimeout("+this.timerID+")")}else{eval(this.timerID+"=null");this.resetTimer()}}function cbcalShowCalendar(){if(this.isShowing()){var a=true;this.getCalendar().style.zIndex=--cbcalZCounter;this.getCalendar().style.visibility="hidden";this.fixSelects(false)}else{var a=false;this.fixSelects(true);this.getCalendar().style.zIndex=++cbcalZCounter;this.getCalendar().style.visibility="visible"}this.handleTimer(a);self.status=""}function cbcalSetElementStatus(a){if(this.yeardropdownstop==""){this.getYearField().style.visibility=(a)?"hidden":"visible"}}function cbcalCheckYearChange(d){var b=this.getDayList();var c=this.getMonthList();if(d.options[d.selectedIndex].value==""){var a=cbcalFixDayList(b,31);b.selectedIndex=0;c.selectedIndex=0;this.hideElements(true);this.setHidden("")}else{this.hideElements(false);if(this.isShowing()){this.resetTimer();this.getCalendar().style.zIndex=++cbcalZCounter}if(c.selectedIndex==0){c.selectedIndex=1}var a=cbcalFixDayList(b,cbcalGetDayCount(cbcalGetGoodYear(d.options[d.selectedIndex].value),c.options[c.selectedIndex].value));this.setPicked(d.options[d.selectedIndex].value,c.options[c.selectedIndex].value,a)}}function cbcalCheckMonthChange(c){var b=this.getDayList();var e=this.getYearField();if(c.options[c.selectedIndex].value==""){var a=cbcalFixDayList(b,31);if(this.yeardropdownstop!=""){e.selectedIndex=0}c.selectedIndex=0;b.selectedIndex=0;this.hideElements(true);this.setHidden("")}else{this.hideElements(false);if(this.isShowing()){this.resetTimer();this.getCalendar().style.zIndex=++cbcalZCounter}var a=cbcalFixDayList(b,cbcalGetDayCount(this.picked.yearValue,c.options[c.selectedIndex].value));this.setPicked(this.picked.yearValue,c.options[c.selectedIndex].value,a);if((this.yeardropdownstop!="")&&(e.selectedIndex==0)){var d=cbcalFixYearList(e,this.picked.yearValue)}}}function cbcalCheckDayChange(b){var d=((b.options[0].value=="")?1:0);var c=this.getMonthList();var f=this.getYearField();if(b.options[b.selectedIndex].value==""){var a=cbcalFixDayList(b,31);if(this.yeardropdownstop!=""){f.selectedIndex=0}c.selectedIndex=0;b.selectedIndex=0;this.hideElements(true);this.setHidden("")}else{this.hideElements(false);if(this.isShowing()){this.resetTimer();this.getCalendar().style.zIndex=++cbcalZCounter}if(c.selectedIndex==0){c.selectedIndex=1}var a=cbcalFixDayList(b,cbcalGetDayCount(this.picked.yearValue,c.options[c.selectedIndex].value));this.setPicked(this.picked.yearValue,this.picked.monthIndex,b.options[b.selectedIndex].value);if((this.yeardropdownstop!="")&&(f.selectedIndex==0)){var e=cbcalFixYearList(f,this.picked.yearValue)}}}function cbcalCheckYearInput(a){if((a.value.length==a.defaultValue.length)&&(a.defaultValue!=a.value)){if(this.isShowing()){this.resetTimer();this.getCalendar().style.zIndex=++cbcalZCounter}var b=cbcalGetGoodYear(a.value);var c=this.getMonthList();var d=cbcalFixDayList(this.getDayList(),cbcalGetDayCount(b,c.options[c.selectedIndex].value));this.setPicked(b,c.options[c.selectedIndex].value,d);a.defaultValue=a.value}}function cbcalDateObject(){if(Function.call){var c=this;var b=0}else{var c=arguments[0];var b=1}c.date=(arguments.length==(b+1))?new Date(arguments[b+0]):new Date(cbcalGetGoodYear(arguments[b+0]),arguments[b+1],arguments[b+2]);c.yearValue=c.date.getFullYear();c.monthIndex=c.date.getMonth();c.monthName=cbcalMonthNames[c.monthIndex];c.fullName=c.monthName+" "+c.yearValue;c.day=c.date.getDate();c.dayCount=cbcalGetDayCount(c.yearValue,c.monthIndex);var a=new Date(c.yearValue,c.monthIndex,1);c.firstDay=a.getDay()}function cbcalStoredMonthObject(e,d,c,b){(Function.call)?cbcalDateObject.call(this,d,c,b):cbcalDateObject(this,d,c,b);this.yearPad=this.yearValue.toString();this.monthPad=(this.monthIndex<9)?"0"+String(this.monthIndex+1):this.monthIndex+1;this.dayPad=(this.day<10)?"0"+this.day.toString():this.day;this.monthShort=this.monthName.substr(0,3).toUpperCase();if(e.indexOf("YYYY")==-1){this.yearPad=this.yearPad.substr(2)}if(e.indexOf("/")>=0){var a="/"}else{if(e.indexOf("-")>=0){var a="-"}else{if(e.indexOf(".")>=0){var a="."}else{var a=""}}}if(/DD?.?((MON)|(MM?M?))/.test(e)){this.formatted=this.dayPad+a;this.formatted+=(RegExp.$1.length==3)?this.monthShort:this.monthPad}else{if(/((MON)|(MM?M?))?.?DD?/.test(e)){this.formatted=(RegExp.$1.length==3)?this.monthShort:this.monthPad;this.formatted+=a+this.dayPad}}this.formatted=(e.substr(0,2)=="YY")?this.yearPad+a+this.formatted:this.formatted+a+this.yearPad}function cbcalDisplayMonthObject(d,c,b,a){(Function.call)?cbcalDateObject.call(this,c,b,a):cbcalDateObject(this,c,b,a);this.displayID=d.hiddenFieldName+"_Current_ID";this.getDisplay=new Function("return document.getElementById(this.displayID)");this.dayHover=cbcalDayCellHover;this.goCurrent=new Function(d.objName+".getCalendar().style.zIndex=++cbcalZCounter;"+d.objName+".setDisplayed(cbcalToday.getFullYear(),cbcalToday.getMonth());");if(d.formNumber>=0){this.getDisplay().innerHTML=this.fullName}}function cbcalNeighborMonthObject(b,a,c){(Function.call)?cbcalDateObject.call(this,c):cbcalDateObject(this,c);this.buttonID=b.hiddenFieldName+"_"+a+"_ID";this.hover=new Function("C","O","cbcalNeighborHover(C,O,this)");this.getButton=new Function("return document.getElementById(this.buttonID)");this.go=new Function(b.objName+".getCalendar().style.zIndex=++cbcalZCounter;"+b.objName+".setDisplayed(this.yearValue,this.monthIndex);");if(b.formNumber>=0){this.getButton().title=this.monthName}}function cbcalSetDisplayedMonth(b,a){this.displayed=new cbcalDisplayMonthObject(this,b,a,1);this.previous=new cbcalNeighborMonthObject(this,"Previous",this.displayed.date.getTime()-86400000);this.next=new cbcalNeighborMonthObject(this,"Next",this.displayed.date.getTime()+(86400000*(this.displayed.dayCount+1)));if(this.formNumber>=0){this.getDayTable().innerHTML=this.buildCalendar()}}function cbcalSetPickedMonth(b,c,a){this.picked=new cbcalStoredMonthObject(this.format,b,c,a);this.setHidden(this.picked.formatted);this.setDisplayed(b,c)}function cbcalCalendarObject(g,k,f,a){this.hiddenFieldName=g;this.monthListID=g+"_Month_ID";this.dayListID=g+"_Day_ID";this.yearFieldID=g+"_Year_ID";this.monthDisplayID=g+"_Current_ID";this.calendarID=g+"_ID";this.dayTableID=g+"_DayTable_ID";this.calendarLinkID=this.calendarID+"_Link";this.timerID=this.calendarID+"_Timer";this.objName=g+"_Object";this.format=k;this.formNumber=-1;this.picked=null;this.displayed=null;this.previous=null;this.next=null;this.yeardropdownstop=a;this.setPicked=cbcalSetPickedMonth;this.setDisplayed=cbcalSetDisplayedMonth;this.checkYear=cbcalCheckYearInput;this.fixYear=FixYearInput;this.changeYear=cbcalCheckYearChange;this.changeMonth=cbcalCheckMonthChange;this.changeDay=cbcalCheckDayChange;this.resetTimer=cbcalCalTimerReset;this.hideElements=cbcalSetElementStatus;this.show=cbcalShowCalendar;this.handleTimer=cbcalDoTimer;this.iconHover=cbcalCalIconHover;this.buildCalendar=cbcalBuildCalendarDays;this.pickDay=cbcalPickDisplayDay;this.fixSelects=cbcalFixSelectLists;this.setHidden=new Function("D","if (this.formNumber >= 0) this.getHiddenField().value=D");this.getHiddenField=new Function("return document.forms[this.formNumber].elements[this.hiddenFieldName]");this.getMonthList=new Function("return document.getElementById(this.monthListID)");this.getDayList=new Function("return document.getElementById(this.dayListID)");this.getYearField=new Function("return document.getElementById(this.yearFieldID)");this.getCalendar=new Function("return document.getElementById(this.calendarID)");this.getDayTable=new Function("return document.getElementById(this.dayTableID)");this.getCalendarLink=new Function("return document.getElementById(this.calendarLinkID)");this.getMonthDisplay=new Function("return document.getElementById(this.monthDisplayID)");this.isShowing=new Function("return !(this.getCalendar().style.visibility != 'visible')");function i(l){for(var m=0;m<cbcalMonthNames.length;m++){if(cbcalMonthNames[m].substr(0,3).toUpperCase()==l.toUpperCase()){break}}return m}function e(m,l){m.setPicked(cbcalToday.getFullYear(),cbcalToday.getMonth(),cbcalToday.getDate());if(l){alert("WARNING: The supplied date is not in valid '"+k+"' format: "+f+".\nTherefore, the current system date will be used instead: "+m.picked.formatted)}}if(f!=""){if((this.format=="YYYYMMDD")&&(/^(\d{4})(\d{2})(\d{2})$/.test(f))){this.setPicked(RegExp.$1,parseInt(RegExp.$2,10)-1,RegExp.$3)}else{if((this.format.substr(0,2)=="YY")&&(/^(\d{2,4})(-|\/|\.)/.test(f))){var d=cbcalGetGoodYear(RegExp.$1);if(/(-|\/|\.)(\w{1,3})(-|\/|\.)(\w{1,3})$/.test(f)){var j=RegExp.$2;var b=RegExp.$4;if(/D$/.test(this.format)){var h=b;var c=j}else{var h=j;var c=b}c=(/\d{1,2}/i.test(c))?parseInt(c,10)-1:i(c);this.setPicked(d,c,h)}else{e(this,true)}}else{if(/(-|\/|\.)(\d{2,4})$/.test(f)){var d=cbcalGetGoodYear(RegExp.$2);if(/^(\w{1,3})(-|\/|\.)(\w{1,3})(-|\/|\.)/.test(f)){if(this.format.substr(0,1)=="D"){var h=RegExp.$1;var c=RegExp.$3}else{var c=RegExp.$1;var h=RegExp.$3}c=(/\d{1,2}/i.test(c))?parseInt(c,10)-1:i(c);this.setPicked(d,c,h)}else{e(this,true)}}else{e(this,true)}}}}}function cbcalHtmlMonth(DateName,Required,DefaultDate,InitialStatus){var r="";r+='<select class="inputbox" id="'+DateName+'_Month_ID" onChange="'+DateName+'_Object.changeMonth(this)">';if(!Required){var NoneSelected=(DefaultDate=="")?" selected":"";r+='<option value=""'+NoneSelected+">"+cbcalUnselectedMonthText+"</option>"}for(var i=0;i<12;i++){var MonthSelected=((DefaultDate!="")&&(eval(DateName+"_Object.picked.monthIndex")==i))?" selected":"";r+='<option value="'+i+'"'+MonthSelected+">"+cbcalMonthNames[i]+"</option>"}r+="</select>";return r}function cbcalHtmlDay(DateName,Required,DefaultDate,InitialStatus){var r='<select class="inputbox" id="'+DateName+'_Day_ID" onChange="'+DateName+'_Object.changeDay(this)">';if(!Required){var NoneSelected=(DefaultDate=="")?" selected":"";r+='<option value=""'+NoneSelected+">"+cbcalUnselectedMonthText+"</option>"}for(var j=1;j<=eval(DateName+"_Object.picked.dayCount");j++){var DaySelected=((DefaultDate!="")&&(eval(DateName+"_Object.picked.day")==j))?" selected":"";r+='<option value="'+j+'"'+DaySelected+">"+j+"</option>"}r+="</select>";return r}function cbcalHtmlYearDropDown(DateName,Required,DefaultDate,InitialStatus,YearDropDownStop,YearMin,YearMax){var r='<select class="inputbox" id="'+DateName+'_Year_ID" onChange="'+DateName+'_Object.changeYear(this)">';if(!Required){var NoneSelected=(DefaultDate=="")?" selected":"";r+='<option value=""'+NoneSelected+">"+cbcalUnselectedMonthText+"</option>"}var digits=eval(DateName+"_Object.picked.yearPad.length");var defaultYear=eval(DateName+"_Object.picked.yearPad");var yearsToShow,modulo,y;modulo=10000;if(YearMin===null&&YearMax===null){yearsToShow=220;y=defaultYear-107}else{yearsToShow=YearMax-YearMin+1;y=YearMin}if(digits==2){if(yearsToShow>100){yearsToShow=100}modulo=100;if(YearMin===null&&YearMax===null){y=cbcalY2kPivotPoint}else{y=YearMin%modulo}}for(var j=0;j<yearsToShow;j++){var YearSelected=((DefaultDate!="")&&(eval(DateName+"_Object.picked.yearPad")==y))?" selected":"";var yy=(y<10?"0":"")+y;r+='<option value="'+yy+'"'+YearSelected+">"+yy+"</option>";y=(y+1)%modulo}r+="</select>";return r}function cbcalHtmlYear(DateName,Required,DefaultDate,InitialStatus){return"<input"+InitialStatus+' class="inputbox" type="text" id="'+DateName+'_Year_ID" size="'+eval(DateName+"_Object.picked.yearPad.length")+'" maxlength="'+eval(DateName+"_Object.picked.yearPad.length")+'" title="Year" value="'+eval(DateName+"_Object.picked.yearPad")+'" onKeyPress="return cbcalYearDigitsOnly(event)" onKeyUp="'+DateName+'_Object.checkYear(this)" onBlur="'+DateName+'_Object.fixYear(this)" />'}function cbcalHtmlYmdReplace(i,f,o,h,b,a,j,p){var e=cbcalHtmlMonth(i,f,h,b);var k=cbcalHtmlDay(i,f,h,b);if(a==""){var n=cbcalHtmlYear(i,f,h,b)}else{var n=cbcalHtmlYearDropDown(i,f,h,b,a,j,p)}var l=0;var g=o.replace(/(Y{2,4})|((MON)|(MM?M?))|(DD?)/g,function(c){var d="";if(/(Y{2,4})/g.test(c)){d=n}else{if(/((MON)|(MM?M?))/.test(c)){d=e}else{if(/(DD?)/.test(c)){d=k}}}if(l++){d="&nbsp;&nbsp;"+d}d+="&nbsp;";return d});return g}function cbcalDateHtml(DateName,Required,DateFormat,DefaultDate,DateFieldName,AdditionalInputAttributes,YearDropDownStop,YearMin,YearMax){var calhtml;if(arguments.length==0){calhtml=("<span style=\"color:red;font-size:1px;font-family:Tahoma;\">ERROR: Missing required parameter in call to 'cbcalDateInput': [name of hidden date field].</span>")}else{if(arguments.length<3){DateFormat=cbcalDefaultDateFormat;if(arguments.length<2){Required=false}}else{if(/^(Y{2,4}(-|\/|\.)?)?((MON)|(MM?M?)|(DD?))(-|\/|\.)?((MON)|(MM?M?)|(DD?))((-|\/|\.)Y{2,4})?$/i.test(DateFormat)){DateFormat=DateFormat.toUpperCase()}else{var AlertMessage="WARNING: The supplied date format for the '"+DateName+"' field is not valid: "+DateFormat+"\nTherefore, the default date format will be used instead: "+cbcalDefaultDateFormat;DateFormat=cbcalDefaultDateFormat;if(arguments.length==4){var CurrentDate=new cbcalStoredMonthObject(DateFormat,cbcalToday.getFullYear(),cbcalToday.getMonth(),cbcalToday.getDate());AlertMessage+="\n\nThe supplied date ("+DefaultDate+") cannot be interpreted with the invalid format.\nTherefore, the current system date will be used instead: "+CurrentDate.formatted;DefaultDate=CurrentDate.formatted}alert(AlertMessage)}}if(!CurrentDate){var CurrentDate=new cbcalStoredMonthObject(DateFormat,cbcalToday.getFullYear(),cbcalToday.getMonth(),cbcalToday.getDate())}if((arguments.length<4)||(DefaultDate=="")){DefaultDate=(Required)?CurrentDate.formatted:""}if(arguments.length<5){DateFieldName=DateName}if(arguments.length<6){AdditionalInputAttributes=""}if(arguments.length<7){YearDropDownStop="1"}if(arguments.length<8){YearMin=null}if(arguments.length<9){YearMax=null}eval(DateName+"_Object=new cbcalCalendarObject('"+DateName+"','"+DateFormat+"','"+DefaultDate+"','"+YearDropDownStop+"')");if((Required)||((arguments.length>=4)&&(DefaultDate!=""))){var InitialStatus="";var InitialDate=eval(DateName+"_Object.picked.formatted")}else{var InitialStatus=' style="visibility:hidden"';var InitialDate="";eval(DateName+"_Object.setPicked("+cbcalToday.getFullYear()+","+cbcalToday.getMonth()+","+cbcalToday.getDate()+")")}calhtml=('<span class="cbDateinputJs" style="white-space:nowrap;">');for(var f=0;f<document.forms.length;f++){for(var e=0;e<document.forms[f].elements.length;e++){if(typeof document.forms[f].elements[e].type=="string"){if((document.forms[f].elements[e].type=="hidden")&&(document.forms[f].elements[e].id==DateName)){eval(DateName+"_Object.formNumber="+f);break}}}}calhtml+=(cbcalHtmlYmdReplace(DateName,Required,DateFormat,DefaultDate,InitialStatus,YearDropDownStop,YearMin,YearMax));calhtml+=('<a id="'+DateName+'_ID_Link" href="javascript:'+DateName+'_Object.show()" onMouseOver="return '+DateName+'_Object.iconHover(true)" onMouseOut="return '+DateName+'_Object.iconHover(false)"><img src="'+cbcalImageURL+'" align="baseline" title="Calendar" border="0" width="16px" height="15px" /></a>&nbsp;');calhtml+=('<span style="position:relative;"><span id="'+DateName+'_ID" style="position:absolute;visibility:hidden;width:'+(cbcalCellWidth*7)+"px;background-color:"+cbcalCalBGColor+';border:1px solid dimgray;" onMouseOver="'+DateName+'_Object.handleTimer(true)" onMouseOut="'+DateName+'_Object.handleTimer(false)">');calhtml+="\n"+('<table class="cbDateinputCalTable" width="'+(cbcalCellWidth*7)+'" cellspacing="0" cellpadding="1">'+String.fromCharCode(13)+'<tr style="background-color:'+cbcalTopRowBGColor+';">');calhtml+="\n"+('<td id="'+DateName+'_Previous_ID" style="cursor:default" align="center" class="calendarDateInput" style="height:'+cbcalCellHeight+'" onClick="'+DateName+'_Object.previous.go()" onMouseDown="cbcalVirtualButton(this,true)" onMouseUp="cbcalVirtualButton(this,false)" onMouseOver="return '+DateName+'_Object.previous.hover(this,true)" onMouseOut="return '+DateName+'_Object.previous.hover(this,false)" title="'+eval(DateName+"_Object.previous.monthName")+'"><img src="'+cbcalPrevURL+'" /></td>');calhtml+="\n"+('<td id="'+DateName+'_Current_ID" style="cursor:pointer" align="center" class="calendarDateInput" style="height:'+cbcalCellHeight+'" colspan="5" onClick="'+DateName+'_Object.displayed.goCurrent()" onMouseOver="self.status=\'Click to view '+CurrentDate.fullName+'\';return true;" onMouseOut="self.status=\'\';return true;" title="Show Current Month">'+eval(DateName+"_Object.displayed.fullName")+"</td>");calhtml+="\n"+('<td id="'+DateName+'_Next_ID" style="cursor:default" align="center" class="calendarDateInput" style="height:'+cbcalCellHeight+'" onClick="'+DateName+'_Object.next.go()" onMouseDown="cbcalVirtualButton(this,true)" onMouseUp="cbcalVirtualButton(this,false)" onMouseOver="return '+DateName+'_Object.next.hover(this,true)" onMouseOut="return '+DateName+'_Object.next.hover(this,false)" title="'+eval(DateName+"_Object.next.monthName")+'"><img src="'+cbcalNextURL+'" /></td></tr>'+String.fromCharCode(13)+"<tr>");for(var w=0;w<7;w++){calhtml+="\n"+('<td width="'+cbcalCellWidth+'" align="center" class="calendarDateInput" style="height:'+cbcalCellHeight+";width:"+cbcalCellWidth+'px;font-weight:bold;border-top:1px solid dimgray;border-bottom:1px solid dimgray;">'+cbcalWeekDays[w]+"</td>")}calhtml+="\n"+("</tr>"+String.fromCharCode(13)+"</table>"+String.fromCharCode(13)+'<span id="'+DateName+'_DayTable_ID">'+eval(DateName+"_Object.buildCalendar()")+"</span>"+String.fromCharCode(13)+"</span></span>"+String.fromCharCode(13)+"</span>")}return calhtml}function cbcalDateInput(e,c,h,d,b,i,a,f,g){if(arguments.length<5){b=e}if(arguments.length<6){i=""}if(arguments.length<7){a="1"}if(arguments.length<8){f=null}if(arguments.length<9){g=null}document.write('<input type="hidden" name="'+b+'" id="'+e+'" value="" '+i+" />");document.write(cbcalDateHtml(e,c,h,d,b,i,a,f,g))};